% This is the Reed College LaTeX thesis template. Most of the work
% for the document class was done by Sam Noble (SN), as well as this
% template. Later comments etc. by Ben Salzberg (BTS). Additional
% restructuring and APA support by Jess Youngberg (JY).
% Your comments and suggestions are more than welcome; please email
% them to cus@reed.edu
%
% See http://web.reed.edu/cis/help/latex.html for help. There are a
% great bunch of help pages there, with notes on
% getting started, bibtex, etc. Go there and read it if you're not
% already familiar with LaTeX.
%
% Any line that starts with a percent symbol is a comment.
% They won't show up in the document, and are useful for notes
% to yourself and explaining commands.
% Commenting also removes a line from the document;
% very handy for troubleshooting problems. -BTS

% As far as I know, this follows the requirements laid out in
% the 2002-2003 Senior Handbook. Ask a librarian to check the
% document before binding. -SN

%%
%% Preamble
%%
% \documentclass{<something>} must begin each LaTeX document
\documentclass[12pt,twoside]{reedthesis}
% Packages are extensions to the basic LaTeX functions. Whatever you
% want to typeset, there is probably a package out there for it.
% Chemistry (chemtex), screenplays, you name it.
% Check out CTAN to see: http://www.ctan.org/
%%
\usepackage{graphicx,latexsym}
\usepackage[french]{babel} 
\usepackage{amsmath}
\usepackage{amssymb,amsthm}
\usepackage{xcolor}
\usepackage{eso-pic}
\usepackage{longtable,booktabs,setspace}
\usepackage{chemarr} %% Useful for one reaction arrow, useless if you're not a chem major
\usepackage[hyphens]{url}
\usepackage{tikz}
\usetikzlibrary{calc}
\newcommand\HRule{\rule{\textwidth}{1pt}}
% Added by CII
\usepackage{hyperref}
\usepackage{lmodern}
\usepackage{float}
\floatplacement{figure}{H}
% End of CII addition
\usepackage{rotating}

% Next line commented out by CII
%%% \usepackage{natbib}
% Comment out the natbib line above and uncomment the following two lines to use the new
% biblatex-chicago style, for Chicago A. Also make some changes at the end where the
% bibliography is included.
%\usepackage{biblatex-chicago}
%\bibliography{thesis}

% Added by CII (Thanks, Hadley!)
% Use ref for internal links
\renewcommand{\hyperref}[2][???]{\autoref{#1}}
\def\chapterautorefname{Chapter}
\def\sectionautorefname{Section}
\def\subsectionautorefname{Subsection}
% End of CII addition

% Added by CII
\usepackage{caption}
\captionsetup{width=5in}
% End of CII addition

% \usepackage{times} % other fonts are available like times, bookman, charter, palatino

% To pass between YAML and LaTeX the dollar signs are added by CII
\title{THÈSE}
\author{Keurcien LUU}
\labo{Techniques de l'Ingénierie Médicale et de la Complexité - Informatique,
Mathématiques et Applications de Grenoble (TIMC-IMAG)}
% The month and year that you submit your FINAL draft TO THE LIBRARY (May or December)
\date{31 octobre 2017}
\division{Mathematics and Natural Sciences}
\advisor{Michael BLUM}
%If you have two advisors for some reason, you can use the following
% Uncommented out by CII
% End of CII addition

%%% Remember to use the correct department!
\department{Ingénierie de la Santé, de la Cognition et Environnement (EDISCE)}
% if you're writing a thesis in an interdisciplinary major,
% uncomment the line below and change the text as appropriate.
% check the Senior Handbook if unsure.
%\thedivisionof{The Established Interdisciplinary Committee for}
% if you want the approval page to say "Approved for the Committee",
% uncomment the next line
%\approvedforthe{Committee}

% Added by CII
%%% Copied from knitr
%% maxwidth is the original width if it's less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\renewcommand{\contentsname}{Table of Contents}
% End of CII addition

\setlength{\parskip}{0pt}

% Added by CII

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\Acknowledgements{
The preface pretty much says it all. \par  Second paragraph of abstract
starts here.
}

\Dedication{

}

\Preface{
The preface pretty much says it all. \par
}

\Abstract{
The preface pretty much says it all. \par  Second paragraph of abstract
starts here.
}

% End of CII addition
%%
%% End Preamble
%%
%

\begin{document}

% Everything below added by CII
      \maketitle
  
  \frontmatter % this stuff will be roman-numbered
  \pagestyle{empty} % this removes page numbers from the frontmatter

      \begin{acknowledgements}
      The preface pretty much says it all. \par  Second paragraph of abstract
      starts here.
    \end{acknowledgements}
  
      \begin{preface}
      The preface pretty much says it all. \par
    \end{preface}
  
      \hypersetup{linkcolor=black}
    \setcounter{tocdepth}{2}
    \tableofcontents
  
      \listoftables
  
      \listoffigures
  
      \begin{abstract}
      The preface pretty much says it all. \par  Second paragraph of abstract
      starts here.
    \end{abstract}
  
  
  \mainmatter % here the regular arabic numbering starts
  \pagestyle{fancyplain} % turns page numbering back on

  \chapter*{Introduction}\label{introduction}
  \addcontentsline{toc}{chapter}{Introduction}
  
  \section*{Données en grande
  dimension}\label{donnees-en-grande-dimension}
  \addcontentsline{toc}{section}{Données en grande dimension}
  
  L'accumulation de données, aussi bien en termes d'observations qu'en
  termes de variables, laisse à penser que le traitement de celles-ci
  pourrait permettre de détecter efficacement les variables qui sont
  responsables ou qui influencent un phénomène particulier. Cela pourrait
  être par exemple l'utilisation de bases de données automobiles pour
  prédire la durée de vie de véhicules neufs, ou encore celle de données
  météorologiques pour savoir s'il pleuvra ou non dans les jours qui
  viennent. Cette accumulation massive s'accompagne tout de même d'un
  phénomène bien connu en statistiques, phénomène qui porte le nom de
  ``curse of dimensionality'' (Giraud, 2014).
  
  \chapter{État de l'art}\label{etat-de-lart}
  
  \begin{itemize}
  \item
    Modèle de FLK
  \item
    Modèle de OutFLANK
  \item
    Modèle de Bayescan
  \item
    Fast PCA
  \item
    ACP en génétique des populations
  \item
    Partie III: R package pcadapt
  \end{itemize}
  
  \section{Analyse en Composantes Principales
  parcimonieuse}\label{analyse-en-composantes-principales-parcimonieuse}
  
  \section{Bootstrap ACP}\label{bootstrap-acp}
  
  \section{Contexte}\label{contexte}
  
  \section{Tests multiples}\label{tests-multiples}
  
  \section{Contrôle du taux de fausse
  découverte}\label{controle-du-taux-de-fausse-decouverte}
  
  Le taux de fausse découverte, correspond à la proportion de faux
  positifs parmi les positifs. En notant \(FP\) le nombre de faux
  positifs, \(FP\) le nombre de vrais positifs, on définit le taux de
  fausse découverte \(FDR\) par :
  \[ FDR = \mathbb{E}\Big[\frac{FP}{TP + FP} 1_{FP+TP > 0}\Big] \] -
  Référence cours de Christophe Giraud
  
  q-value, bonferroni, benjamini-hochberg La figure suivante donne les
  comparaisons entre les différentes procédures de correction :
  
  \chapter{Adaptation locale}\label{adaptation-locale}
  
  Une population est dite localement adaptée à son environnement si elle a
  connu une évolution différente de celles qu'ont connu les autres
  populations de la même espèce, et ce, en réponse aux pressions
  sélectives auxquelles elle peut être confrontrée.
  
  \section{Cas d'étude utilisant
  pcadapt}\label{cas-detude-utilisant-pcadapt}
  
  \section{POOP}\label{poop}
  
  \chapter{Introgression adaptative}\label{introgression-adaptative}
  
  \section{Qu'est-ce que l'introgression
  ?}\label{quest-ce-que-lintrogression}
  
  Avant de s'intéresser à la notion d'introgression, intéressons-nous
  d'abord à celle d'hybridation. L'hybridation peut être définie comme la
  reproduction entre deux individus appartenant à deux espèces ou à deux
  populations différentes. Cette définition nous amène à nous poser deux
  questions. La première, relative à la notion d'espèce, est souvent
  sujette à controverse. La seconde concerne quant à elle la désignation
  de populations différentes. Qu'est-ce qui fait que deux groupes
  d'individus sont différents ? Harrison suggère en 1990 que deux
  individus issus de populations différentes doivent chacun posséder des
  traits héritables qui les différencient (Harrison \& others, 1990).
  
  Nous parlons d'introgression lorsqu'un certain nombre de gènes est
  transféré d'une population à une autre.
  
  L'étude de régions génomiques présentant des caractéristiques
  d'introgression ou de divergence peut se révéler intéressante pour
  plusieurs raisons.
  
  \section{Coefficients de métissage globaux et
  locaux}\label{coefficients-de-metissage-globaux-et-locaux}
  
  Étant données des populations ancestrales, il est possible d'estimer
  pour un individu donné, la proportion de son génôme provenant de chacune
  des populations ancestrales. Ces proportions sont connues plus
  communément sous le nom de \emph{coefficients de métissage globaux}. De
  nombreux logiciels existent pour l'estimation de ces coefficients :
  STRUCTURE, ADMIXTURE (Alexander, Novembre, \& Lange, 2009), LEA (Frichot
  \& François, 2015), tess3r (Caye, Deist, Martins, Michel, \& François,
  2016). En complément à cette information globale, il peut être
  intéressant de déterminer sur des portions plus petites du génôme, de la
  même manière que dans le cas global, les proportions venant de telle ou
  telle population ancestrale pour chacune de ces portions. Nous parlons
  dans ce cas de \emph{coefficients de métissage locaux}. Encore une fois,
  plusieurs logiciels ont été proposés dans le but d'estimer ces
  coefficients : Hapmix (Price et al., 2009), EILA (Yang, Li, Buu, \&
  Williams, 2013), LAMP (Thornton \& Bermejo, 2014), loter ou encore RFmix
  (Maples, Gravel, Kenny, \& Bustamante, 2013).
  
  \section{Introgression}\label{introgression}
  
  L'introgression peut être détectée de différentes façons. Une première
  approche consiste à utiliser les \emph{coefficients de métissage
  locaux}. Les méthodes mentionnées plus haut estiment ces coefficients
  pour chaque individu, permettant de calculer à partir de ceux-ci des
  coefficients de métissage locaux pour chaque population.
  
  \section{Lien entre Analyse en Composantes Principales et métissage
  global.}\label{lien-entre-analyse-en-composantes-principales-et-metissage-global.}
  
  L'un des premiers articles à établir un lien entre l'ACP et les
  coefficients de métissage global fut sur l'interprétation généalogique
  de l'ACP de Gil McVean (McVean, 2009):
  
  Coefficients de métissage et ACP
  
  Pour chacun des 22 chromosomes,
  
  \section{Analyse en Composantes Principales
  locale}\label{analyse-en-composantes-principales-locale}
  
  Notant \(p\) le nombre de marqueurs génétiques, \(i\) un entier compris
  entre \(1\) et \(p\), et \(x_i\) la position génétique (en Morgans) ou
  la position physique (en paires de bases) du \(i\)-ème marqueur
  génétique. Nous définissons pour cet entier \(i\) la fenêtre \(W_i^T\)
  de taille \(T\) et centrée en \(i\) :
  
  \[W_i^T = \{ j \in [|1, p|], |x_i - x_j| \leq T/2 \}\]
  
  \section{Sensibilité à l'imputation des données
  manquantes}\label{sensibilite-a-limputation-des-donnees-manquantes}
  
  \newpage
  
  \subsection{Méthodes de détection}\label{methodes-de-detection}
  
  \subsubsection{Etat de l'art}\label{etat-de-lart-1}
  
  \paragraph{Scénario à flux de gènes}\label{scenario-a-flux-de-genes}
  
  \subparagraph{La statistique D de
  Patterson}\label{la-statistique-d-de-patterson}
  
  La statistique \(D\) de Patterson (Durand, Patterson, Reich, \& Slatkin,
  2011) demeure aujourd'hui la méthode la plus utilisée pour détecter la
  trace de flux de gènes dans une population. La méthode repose sur
  l'observation de motifs portant les noms \emph{ABBA} et \emph{BABA}, en
  référence aux différents types de généalogie possible pour un site
  nucléotidique.
  
  \[ D = \displaystyle \frac{\sum_i C_{ABBA}(i) - C_{BABA}(i)}{\sum_i C_{ABBA}(i) + C_{BABA}(i)} \]
  
  \subparagraph{RNDmin}\label{rndmin}
  
  {[}Descriptif de RNDmin{]}
  
  Pour comprendre la récente méthode proposée par (Rosenzweig, Pease,
  Besansky, \& Hahn, 2016), il est nécessaire de définir un certain nombre
  de statistiques dont \(RND_{\text{min}}\) dérive.
  
  ~
  
  \begin{itemize}
  \tightlist
  \item
    \(d_{xy}\) est la distance de Hamming entre la séquence \(X\) de la
    population \(1\) et la séquence \(Y\) de la population \(2\). Ainsi,
    si \(x = (x_i)_{1 \leq i \leq n}\) et \(y = (y_i)_{1 \leq i \leq n}\),
    alors :
  \end{itemize}
  
  \[d_{xy} = \text{Card}(\{i \in [|1, n|] \; | \; x_i \neq y_i \})\]
  
  Cette statistique est ainsi définie pour une paire de séquences (\(x\),
  \(y\)). Pour quantifier la dissimilarité entre deux ensembles de
  séquences, deux approches sont possibles. La première consiste à
  calculer la distance moyenne \(d_{XY}\). De par sa définition, cette
  distance présente néanmoins le défaut d'être peu sensible aux épisodes
  récents d'introgression (Geneva, Muirhead, Kingan, \& Garrigan, 2015).
  En effet, les faibles valeurs de \(d_{xy}\) correspondant à des
  évènements de divergence récents peuvent voir leur influence diminuée en
  cas de présence d'évènements de divergence plus anciens. Pour pallier à
  ce problème, considérer la distance minimale entre les deux ensembles de
  séquences (Joly, McLenachan, \& Lockhart, 2009) constitue une solution
  intéressante.
  
  {[}Expliquer pourquoi on définit \(d_{\text{out}}\) et \(RND\){]}
  
  En définissant \(d_{out} = \frac{1}{2}(d_{XO} + d_{YO})\), il est
  possible de définir de la même façon \(RND_{min}\) :
  
  \[RND_{\text{min}} = \frac{d_{\text{min}}}{d_{\text{out}}}\]
  
  Pour récapituler, \(RND_{\text{min}}\) est une statistique robuste aux
  variations de taux de mutation et qui reste sensible aux récents
  évènements d'introgression. En pratique, l'introduction de
  \(d_{\text{out}}\) requiert ainsi la donnée d'une population ancestrale
  commune aux deux populations d'intérêt.
  
  \subparagraph{Bdf}\label{bdf}
  
  \paragraph{Analyse Linéaire
  Discriminante}\label{analyse-lineaire-discriminante}
  
  \subsubsection{Régression linéaire, régression logistique, forêts
  aléatoires et importance des
  variables}\label{regression-lineaire-regression-logistique-forets-aleatoires-et-importance-des-variables}
  
  \subsubsection{Régression locale, package mgcv, locfit, Backward
  selection
  strategy}\label{regression-locale-package-mgcv-locfit-backward-selection-strategy}
  
  \subsubsection{ACP locale et espace de
  formes}\label{acp-locale-et-espace-de-formes}
  
  \newpage
  
  \section{Simulations}\label{simulations}
  
  \subsection{Données de peupliers}\label{donnees-de-peupliers}
  
  Le premier jeu de données est issu d'une étude d'introgression
  adaptative chez les peupliers d'Amérique du Nord (Suarez-Gonzalez,
  2016). La simulation d'haplotypes d'individus admixés est effectuée à
  partir des deux populations ancestrales qui y sont présentes. La
  première, \emph{Populus Balsamifera}, est une espèce de peupliers qui
  peuple le nord du continent nord-américain, d'Est en Ouest, et se trouve
  exposée à des conditions climatiques peu clémentes.La seconde,
  \emph{Populus Trichocarpa}, est principalement localisée en Californie,
  et bénéficie d'un climat continental.
  
  Chacune des simulations est constituée de \(50\) haplotypes de la souche
  continentale, de \(50\) haplotyêpes de la souche boréale, ainsi que de
  \(50\) haplotypes d'individus hybrides générés à partir des haplotypes
  ancestraux. Ces haplotypes ancestraux ont été estimés à l'aide du
  logiciel Beagle. A partir des positions en paires de base, une carte de
  recombinaison génétique est générée en utilisant le taux de
  recombinaison moyen chez le peuplier. Le taux de recombinaison, noté
  \(\tau_r\), correspond au nombre moyen de paires de bases à parcourir
  pour qu'ait lieu un épisode de recombinaison génétique, \emph{i.e.},
  notant \(L\) la longueur du chromosome en Morgans (\(M\)), et \(N_{bp}\)
  le nombre de paires de bases le constituant, le taux de recombinaison
  génétique pour ce chromosome est donné par la relation:
  
  \[\tau_r = \frac{L}{N_{bp}}\]
  
  Dans ce scénario, les simulations ont été produites en utilisant un taux
  de recombinaison génétique moyen \(\tau_r\) de \(0.05\) centiMorgans par
  million de paire de bases, correspondant à la valeur utilisée par les
  auteurs de l'étude avec le logiciel RASPberry
  (\textit{Recombination via Ancestry Switch Probability}). A partir de la
  donnée de la position physique en paires de bases ainsi que du taux de
  recombinaison moyen, nous générons une carte de recombinaison génétique
  adaptée à nos simulations.
  
  \subsection{Génération aléatoire d'individus
  hybrides}\label{generation-aleatoire-dindividus-hybrides}
  
  Pour simuler un individu métissé, il est d'abord nécessaire de simuler
  l'emplacement des évènements de recombinaison. Pour ce faire, nous
  utilisons le modèle décrit dans (Price et al., 2009), en parcourant
  
  \(\lambda = 0.001\)
  
  \(\lambda = 0.01\)
  
  \(\lambda = 0.1\)
  
  \newpage
  
  \subsection{Simulations à partir de ms et
  Seq-Gen}\label{simulations-a-partir-de-ms-et-seq-gen}
  
  Dans le scénario d'introgression via flux de gènes, nous nous inspirons
  des modèles de simulation décrits dans (Martin \& Jiggins, 2015). Ces
  modèles sont largement repris dans la littérature pour l'évaluation de
  statistiques telles que \(RND_{min}\) (Rosenzweig et al., 2016) et
  \(Bd_f\) (Pfeifer \& Kapan, 2017). Chaque simulation est constituée de
  100 individus. Un individu est généré en concaténant un certain nombre
  de séquences de nucléotides, d'une longueur fixée à 5000 paires de bases
  par séquence. Chacune de ces séquences est elle-même simulée suivant un
  modèle neutre ou alternatif. Le modèle neutre décrit un scénario
  démographique classique de populations divergentes. Le modèle alternatif
  décrit quant à lui un scénario légèrement différent, et servira à
  caractériser les séquences \emph{introgressées}. Les lignes de commande
  \emph{ms} permettant de générer les séquences de nucléotides pour le
  modèle neutre ainsi que pour le modèle alternatif sont données
  ci-dessous :
  
  ~
  
  \begin{itemize}
  \tightlist
  \item
    Modèle neutre :
  \end{itemize}
  
  \begin{verbatim}
  ./ms 200 1 -I 4 50 50 50 50 -ej 1 2 1 -ej 2 3 1 -ej 3 4 1 
  -r 50 5000 -T 
  \end{verbatim}
  
  Modèle neutre. \(12N\) genérations auparavant, premier épisode de
  divergence donnant naissance à P1 et à O. \(8N\) générations auparavant,
  deuxième épisode de divergence voyant l'apparition de P3. \(4N\)
  générations auparavant, dernier épisode de divergence et apparition de
  P2.
  
  ~
  
  \begin{itemize}
  \tightlist
  \item
    Modèle alternatif :
  \end{itemize}
  
  \begin{verbatim}
  ./ms 200 1 -I 4 50 50 50 50 -ej 1 2 1 -ej 2 3 1 -ej 3 4 1 
  -es 0.1 2 0.8 -ej 0.1 5 3 -r 50 5000 -T
  \end{verbatim}
  
  Modèle alternatif. \(12N\) genérations auparavant, premier épisode de
  divergence donnant naissance à P1 et à O. \(8N\) générations auparavant,
  deuxième épisode de divergence voyant l'apparition de P3. \(4N\)
  générations auparavant, dernier épisode de divergence et apparition de
  P2. \(t\) unités de temps auparavant, épisode de flux de gènes de P3
  vers la population P2.
  
  La variable \(f\) présente en figure \ref{fig:alternate} représente le
  taux d'introgression, elle quantifie la proportion d'haplotypes présents
  dans la population P2 et qui proviennent de la population P3. Ainsi, une
  valeur de \(f\) égale à \(1\) reviendrait à simuler un épisode de
  divergence de la population P3, duquel découlerait la naissance de la
  population P2. La valeur de \(f\) utilisée ci-dessus est \(0.2\),
  signifiant que 20\% des haplotypes présents dans la population 2 sont
  issus de la population P3.
  
  \subsection{Résultats de la comparaison des
  logiciels}\label{resultats-de-la-comparaison-des-logiciels}
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \NormalTok{im.df <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{methods =} \KeywordTok{c}\NormalTok{(}\StringTok{"Bdf"}\NormalTok{, }\StringTok{"D"}\NormalTok{, }\StringTok{"f_d"}\NormalTok{, }\StringTok{"pcadapt"}\NormalTok{, }\StringTok{"RNDmin"}\NormalTok{),}
                      \DataTypeTok{input =} \KeywordTok{c}\NormalTok{(}\StringTok{"genoytpes"}\NormalTok{, }\StringTok{"genoytpes"}\NormalTok{, }\StringTok{"genoytpes"}\NormalTok{, }\StringTok{"genoytpes"}\NormalTok{, }\StringTok{"haplotypes"}\NormalTok{),}
                      \DataTypeTok{nb_of_pop =} \KeywordTok{c}\NormalTok{(}\StringTok{"4"}\NormalTok{, }\StringTok{"4"}\NormalTok{, }\StringTok{"4"}\NormalTok{, }\StringTok{">= 3"}\NormalTok{, }\StringTok{"3"}\NormalTok{),}
                      \DataTypeTok{outgroup =} \KeywordTok{c}\NormalTok{(}\StringTok{"Oui"}\NormalTok{, }\StringTok{"Oui"}\NormalTok{, }\StringTok{"Oui"}\NormalTok{, }\StringTok{"Oui"}\NormalTok{, }\StringTok{"Oui"}\NormalTok{))}
  
  \NormalTok{knitr::}\KeywordTok{kable}\NormalTok{(im.df, }
               \DataTypeTok{col.names =} \KeywordTok{c}\NormalTok{(}\StringTok{"Statistique"}\NormalTok{, }
                             \StringTok{"Format"}\NormalTok{,}
                             \StringTok{"Nombre de populations"}\NormalTok{, }
                             \StringTok{"Dont Outgroup"}\NormalTok{), }
               \DataTypeTok{format =} \StringTok{"latex"}\NormalTok{)}
  \end{Highlighting}
  \end{Shaded}
  
  \begin{tabular}{l|l|l|l}
  \hline
  Statistique & Format & Nombre de populations & Dont Outgroup\\
  \hline
  Bdf & genoytpes & 4 & Oui\\
  \hline
  D & genoytpes & 4 & Oui\\
  \hline
  f\_d & genoytpes & 4 & Oui\\
  \hline
  pcadapt & genoytpes & >= 3 & Oui\\
  \hline
  RNDmin & haplotypes & 3 & Oui\\
  \hline
  \end{tabular}
  
  \paragraph{Scénario de métissage}\label{scenario-de-metissage}
  
  Nous comparons ici notre méthode au logiciel RFMix destiné à la
  détermination de coefficients de métissage local.
  
  10 generations
  
  100 generations
  
  1000 generations
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \KeywordTok{library}\NormalTok{(magrittr)}
  \KeywordTok{source}\NormalTok{(}\StringTok{"R/summarySE.R"}\NormalTok{)}
  
  \NormalTok{res.tp <-}\StringTok{ }\KeywordTok{read.table}\NormalTok{(}\StringTok{"data/results_admixture_setting_1000_tp.txt"}\NormalTok{, }\DataTypeTok{header =} \OtherTok{TRUE}\NormalTok{)}
  \NormalTok{res.fp <-}\StringTok{ }\KeywordTok{read.table}\NormalTok{(}\StringTok{"data/results_admixture_setting_1000_fp.txt"}\NormalTok{, }\DataTypeTok{header =} \OtherTok{TRUE}\NormalTok{)}
  
  \NormalTok{power <-}\StringTok{ }\DecValTok{100} \NormalTok{*}\StringTok{ }\NormalTok{res.tp$true_positives /}\StringTok{ }\DecValTok{5}
  \NormalTok{res.pow <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(res.tp, power)}
  \KeywordTok{colnames}\NormalTok{(res.pow) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(res.tp), }\StringTok{"value"}\NormalTok{)}
  \NormalTok{fdr <-}\StringTok{ }\DecValTok{100} \NormalTok{*}\StringTok{ }\NormalTok{res.fp$false_positives /}\StringTok{ }\NormalTok{(res.tp$true_positives +}\StringTok{ }\NormalTok{res.fp$false_positives)}
  \NormalTok{fdr[}\KeywordTok{is.na}\NormalTok{(fdr)] <-}\StringTok{ }\KeywordTok{mean}\NormalTok{(fdr, }\DataTypeTok{na.rm =} \OtherTok{TRUE}\NormalTok{)}
  \NormalTok{res.fdr <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(res.fp, fdr)}
  \KeywordTok{colnames}\NormalTok{(res.fdr) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(res.fp), }\StringTok{"value"}\NormalTok{)}
  
  \NormalTok{pdf <-}\StringTok{ }\KeywordTok{summarySE}\NormalTok{(res.pow, }\DataTypeTok{measurevar =} \StringTok{"value"}\NormalTok{, }\DataTypeTok{groupvars =} \KeywordTok{c}\NormalTok{(}\StringTok{"method"}\NormalTok{, }\StringTok{"delta_p"}\NormalTok{))}
  \end{Highlighting}
  \end{Shaded}
  
  \begin{verbatim}
  ## -------------------------------------------------------------------------
  \end{verbatim}
  
  \begin{verbatim}
  ## You have loaded plyr after dplyr - this is likely to cause problems.
  ## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
  ## library(plyr); library(dplyr)
  \end{verbatim}
  
  \begin{verbatim}
  ## -------------------------------------------------------------------------
  \end{verbatim}
  
  \begin{verbatim}
  ## 
  ## Attachement du package : 'plyr'
  \end{verbatim}
  
  \begin{verbatim}
  ## The following objects are masked from 'package:dplyr':
  ## 
  ##     arrange, count, desc, failwith, id, mutate, rename, summarise,
  ##     summarize
  \end{verbatim}
  
  \begin{Shaded}
  \begin{Highlighting}[]
  \NormalTok{fdf <-}\StringTok{ }\KeywordTok{summarySE}\NormalTok{(res.fdr, }\DataTypeTok{measurevar =} \StringTok{"value"}\NormalTok{, }\DataTypeTok{groupvars =} \KeywordTok{c}\NormalTok{(}\StringTok{"method"}\NormalTok{, }\StringTok{"delta_p"}\NormalTok{))}
  
  \NormalTok{p0 <-}\StringTok{ }\NormalTok{dplyr::}\KeywordTok{bind_rows}\NormalTok{(}
    \KeywordTok{mutate}\NormalTok{(pdf, }\DataTypeTok{stat =} \StringTok{"Power"}\NormalTok{),}
    \KeywordTok{mutate}\NormalTok{(fdf, }\DataTypeTok{stat =} \StringTok{"False Discovery Rate"}\NormalTok{)}
  \NormalTok{) %>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{stat_f =}  \KeywordTok{factor}\NormalTok{(stat, }\DataTypeTok{levels=}\KeywordTok{c}\NormalTok{(}\StringTok{"Power"}\NormalTok{, }\StringTok{"False Discovery Rate"}\NormalTok{))}
  \NormalTok{) %>%}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \NormalTok{delta_p, }\DataTypeTok{y =} \NormalTok{value, }\DataTypeTok{colour =} \NormalTok{method)) +}\StringTok{ }
  \StringTok{  }\KeywordTok{geom_errorbar}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{ymin =} \NormalTok{value -}\StringTok{ }\NormalTok{se, }\DataTypeTok{ymax =} \NormalTok{value +}\StringTok{ }\NormalTok{se), }
                  \DataTypeTok{width =}\NormalTok{.}\DecValTok{05}\NormalTok{, }\DataTypeTok{size =} \FloatTok{1.5}\NormalTok{) +}
  \StringTok{  }\KeywordTok{ylim}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{105}\NormalTok{) +}\StringTok{ }\KeywordTok{facet_grid}\NormalTok{(~stat_f, }\DataTypeTok{margins =} \StringTok{"am"}\NormalTok{) +}\StringTok{ }\KeywordTok{ylab}\NormalTok{(}\StringTok{""}\NormalTok{) +}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\KeywordTok{expression}\NormalTok{(}\KeywordTok{atop}\NormalTok{(}\KeywordTok{bold}\NormalTok{(}\StringTok{"Difference of ancestry between introgressed"}\NormalTok{), }\KeywordTok{bold}\NormalTok{(}\StringTok{"and non-introgressed regions"}\NormalTok{)))) +}
  \StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\DataTypeTok{size =} \DecValTok{2}\NormalTok{) +}\StringTok{ }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{size =} \FloatTok{1.5}\NormalTok{) +}\StringTok{ }
  \StringTok{  }\KeywordTok{scale_x_reverse}\NormalTok{() +}
  \StringTok{  }\KeywordTok{theme_bw}\NormalTok{() +}\StringTok{ }\KeywordTok{guides}\NormalTok{(}\DataTypeTok{colour =} \KeywordTok{guide_legend}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Method"}\NormalTok{)) +}
  \StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{20}\NormalTok{, }\DataTypeTok{face =} \StringTok{"bold"}\NormalTok{),}
          \DataTypeTok{axis.title.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{margin =} \KeywordTok{margin}\NormalTok{(}\DataTypeTok{t =} \DecValTok{20}\NormalTok{, }\DataTypeTok{r =} \DecValTok{0}\NormalTok{, }\DataTypeTok{b =} \DecValTok{0}\NormalTok{, }\DataTypeTok{l =} \DecValTok{0}\NormalTok{)),}
          \DataTypeTok{axis.title=}\KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{20}\NormalTok{, }\DataTypeTok{face =} \StringTok{"bold"}\NormalTok{),}
          \DataTypeTok{title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{20}\NormalTok{, }\DataTypeTok{face =} \StringTok{"bold"}\NormalTok{),}
          \DataTypeTok{strip.text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{20}\NormalTok{, }\DataTypeTok{face =} \StringTok{"bold"}\NormalTok{),}
          \DataTypeTok{legend.text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{20}\NormalTok{),}
          \DataTypeTok{legend.key.height =} \KeywordTok{unit}\NormalTok{(}\DecValTok{3}\NormalTok{, }\StringTok{"line"}\NormalTok{),}
          \DataTypeTok{legend.key.width =} \KeywordTok{unit}\NormalTok{(}\DecValTok{3}\NormalTok{, }\StringTok{"line"}\NormalTok{))}
  \KeywordTok{print}\NormalTok{(p0)}
  \end{Highlighting}
  \end{Shaded}
  
  \paragraph{Scénario à flux de gènes}\label{scenario-a-flux-de-genes-1}
  
  Dans ce paragraphe, nous comparons notre statistique de test à un
  ensemble de statistiques implémentées dans le package R \emph{PopGenome}
  : la statistique \(D\) de Patterson, RNDmin (Rosenzweig et al., 2016) et
  BDF (Pfeifer \& Kapan, 2017).
  
  \chapter{Aspect computationnel}\label{aspect-computationnel}
  
  Dans cette partie, nous nous intéresserons brièvement à l'aspect
  computationnel des méthodes qui ont été présentées dans les chapitres
  précédents. Le développement d'outils logiciels destinés à l'exploration
  de données génétiques volumineuses requiert qu'une attention toute
  particulière soit portée à l'utilisation des ressources de calcul.
  
  Blockwise computation of covariance matrix Random SVD Storage in binary
  format Memory-mapping
  
  \chapter*{Conclusion}\label{conclusion}
  \addcontentsline{toc}{chapter}{Conclusion}
  
  If we don't want Conclusion to have a chapter number next to it, we can
  add the \texttt{\{-\}} attribute.
  
  \textbf{More info}
  
  And here's some other random info: the first paragraph after a chapter
  title or section head \emph{shouldn't be} indented, because indents are
  to tell the reader that you're starting a new paragraph. Since that's
  obvious after a chapter or section title, proper typesetting doesn't add
  an indent there.
  
  \chapter*{(APPENDIX) Appendix}\label{appendix-appendix}
  \addcontentsline{toc}{chapter}{(APPENDIX) Appendix}
  
  \chapter{The First Appendix}\label{the-first-appendix}
  
  This first appendix includes all of the R chunks of code that were
  hidden throughout the document (using the \texttt{include\ =\ FALSE}
  chunk tag) to help with readibility and/or setup.
  
  \textbf{In the main Rmd file}
  
  \chapter{The Second Appendix, for
  Fun}\label{the-second-appendix-for-fun}
  
  \backmatter
  
  \chapter*{Bibliographie}\label{bibliographie}
  \addcontentsline{toc}{chapter}{Bibliographie}
  
  \noindent
  
  \setlength{\parindent}{-0.20in} \setlength{\leftskip}{0.20in}
  \setlength{\parskip}{8pt}
  
  \hypertarget{refs}{}
  \hypertarget{ref-alexander2009fast}{}
  Alexander, D. H., Novembre, J., \& Lange, K. (2009). Fast model-based
  estimation of ancestry in unrelated individuals. \emph{Genome Research},
  \emph{19}(9), 1655--1664.
  
  \hypertarget{ref-caye2016tess3}{}
  Caye, K., Deist, T. M., Martins, H., Michel, O., \& François, O. (2016).
  TESS3: Fast inference of spatial population structure and genome scans
  for selection. \emph{Molecular Ecology Resources}, \emph{16}(2),
  540--548.
  
  \hypertarget{ref-durand2011testing}{}
  Durand, E. Y., Patterson, N., Reich, D., \& Slatkin, M. (2011). Testing
  for ancient admixture between closely related populations.
  \emph{Molecular Biology and Evolution}, \emph{28}(8), 2239--2252.
  
  \hypertarget{ref-frichot2015lea}{}
  Frichot, E., \& François, O. (2015). LEA: An r package for landscape and
  ecological association studies. \emph{Methods in Ecology and Evolution},
  \emph{6}(8), 925--929.
  
  \hypertarget{ref-geneva2015new}{}
  Geneva, A. J., Muirhead, C. A., Kingan, S. B., \& Garrigan, D. (2015). A
  new method to scan genomes for introgression in a secondary contact
  model. \emph{PloS One}, \emph{10}(4), e0118621.
  
  \hypertarget{ref-giraud2014introduction}{}
  Giraud, C. (2014). \emph{Introduction to high-dimensional statistics}
  (Vol. 138). CRC Press.
  
  \hypertarget{ref-harrison1990hybrid}{}
  Harrison, R. G., \& others. (1990). Hybrid zones: Windows on
  evolutionary process. \emph{Oxford Surveys in Evolutionary Biology},
  \emph{7}, 69--128.
  
  \hypertarget{ref-joly2009statistical}{}
  Joly, S., McLenachan, P. A., \& Lockhart, P. J. (2009). A statistical
  approach for distinguishing hybridization and incomplete lineage
  sorting. \emph{The American Naturalist}, \emph{174}(2), E54--E70.
  
  \hypertarget{ref-maples2013rfmix}{}
  Maples, B. K., Gravel, S., Kenny, E. E., \& Bustamante, C. D. (2013).
  RFMix: A discriminative modeling approach for rapid and robust
  local-ancestry inference. \emph{The American Journal of Human Genetics},
  \emph{93}(2), 278--288.
  
  \hypertarget{ref-martin2000}{}
  Martin, J. W. D., Simon H., \& Jiggins, C. D. (2015). Evaluating the use
  of abba--BABA statistics to locate introgressed loci. \emph{Molecular
  Biology and Evolution}, 244--257.
  
  \hypertarget{ref-mcvean2009genealogical}{}
  McVean, G. (2009). A genealogical interpretation of principal components
  analysis. \emph{PLoS Genetics}, \emph{5}(10), e1000686.
  
  \hypertarget{ref-pfeifer2017estimates}{}
  Pfeifer, B., \& Kapan, D. D. (2017). Estimates of introgression as a
  function of pairwise distances. \emph{BioRxiv}, 154377.
  
  \hypertarget{ref-price2009sensitive}{}
  Price, A. L., Tandon, A., Patterson, N., Barnes, K. C., Rafaels, N.,
  Ruczinski, I., \ldots{} Myers, S. (2009). Sensitive detection of
  chromosomal segments of distinct ancestry in admixed populations.
  \emph{PLoS Genetics}, \emph{5}(6), e1000519.
  
  \hypertarget{ref-rosenzweig2016powerful}{}
  Rosenzweig, B. K., Pease, J. B., Besansky, N. J., \& Hahn, M. W. (2016).
  Powerful methods for detecting introgressed regions from population
  genomic data. \emph{Molecular Ecology}, \emph{25}(11), 2387--2397.
  
  \hypertarget{ref-suarez2016}{}
  Suarez-Gonzalez, et a., Adriana. (2016). Genomic and functional
  approaches reveal a case of adaptive introgression from populus
  balsamifera (balsam poplar) in p. trichocarpa (black cottonwood).
  \emph{Molecular Ecology}, 2427--2442.
  
  \hypertarget{ref-thornton2014local}{}
  Thornton, T. A., \& Bermejo, J. L. (2014). Local and global ancestry
  inference and applications to genetic association analysis for admixed
  populations. \emph{Genetic Epidemiology}, \emph{38}(S1).
  
  \hypertarget{ref-yang2013efficient}{}
  Yang, J. J., Li, J., Buu, A., \& Williams, L. K. (2013). Efficient
  inference of local ancestry. \emph{Bioinformatics}, \emph{29}(21),
  2750--2756.
  
  % Index?

\end{document}

